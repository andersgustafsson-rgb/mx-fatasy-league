<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rider Management - MX Fantasy League</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { 
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-color: #22d3ee;
            color: #22d3ee;
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.3);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <div class="container mx-auto p-4 sm:p-6">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center space-x-4">
                <a href="/" class="text-2xl font-bold text-cyan-400 hover:text-cyan-300 transition-colors">üèÅ MX Fantasy</a>
                <span class="text-cyan-400">|</span>
                <h1 class="text-2xl font-bold text-cyan-400">üë• Rider Management</h1>
            </div>
            <div class="flex items-center space-x-4">
                <a href="/admin" class="bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded transition-colors">‚Üê Tillbaka till Admin</a>
            </div>
        </div>

        <!-- Search Function -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 mb-6">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">üîç S√∂k F√∂rare</h3>
            <div class="flex flex-col sm:flex-row gap-3">
                <input 
                    type="text" 
                    id="riderSearch" 
                    placeholder="S√∂k efter namn, nummer, team eller pris..." 
                    class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent dark:bg-gray-700 dark:text-white"
                >
                <button 
                    onclick="searchRiders()" 
                    class="bg-cyan-600 hover:bg-cyan-700 text-white px-6 py-2 rounded-lg transition-colors"
                >
                    S√∂k
                </button>
                <button 
                    onclick="clearSearch()" 
                    class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"
                >
                    Rensa
                </button>
            </div>
            <div id="searchResults" class="mt-4 hidden">
                <h4 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2">S√∂kresultat:</h4>
                <div id="searchResultsList" class="space-y-2"></div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="flex flex-wrap gap-2 mb-6">
            <button class="tab-button active px-4 py-2 rounded border-2 border-gray-600 bg-gray-800 text-white transition-all" data-tab="250">
                250cc
            </button>
            <button class="tab-button px-4 py-2 rounded border-2 border-gray-600 bg-gray-800 text-white transition-all" data-tab="450">
                450cc
            </button>
        </div>

        <!-- 250cc Tab -->
        <div id="250" class="tab-content active">
            <div class="bg-gradient-to-r from-gray-900 to-black rounded-lg shadow-2xl border-2 border-cyan-400 overflow-hidden" style="box-shadow: 0 0 20px rgba(34, 211, 238, 0.3);">
                <div class="bg-gradient-to-r from-cyan-500 to-blue-500 px-4 py-3" style="box-shadow: 0 0 15px rgba(34, 211, 238, 0.5);">
                    <h2 class="text-xl font-bold text-center text-white" style="text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);">üèçÔ∏è 250cc Riders</h2>
                </div>
                <div class="p-4 bg-gray-900">
                    <!-- Add New Rider Form -->
                    <div class="mb-6 p-4 bg-gray-800 rounded border border-cyan-400" style="box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);">
                        <h3 class="text-lg font-semibold text-cyan-400 mb-4">‚ûï L√§gg till ny f√∂rare</h3>
                        <form id="add-rider-form-250" class="grid grid-cols-1 md:grid-cols-6 gap-4">
                            <input type="hidden" name="class_name" value="250cc">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Nummer</label>
                                <input type="number" name="rider_number" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Namn</label>
                                <input type="text" name="name" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Coast</label>
                                <select name="coast_250" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                                    <option value="">V√§lj coast</option>
                                    <option value="east">East</option>
                                    <option value="west">West</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">M√§rke</label>
                                <select name="bike_brand" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                                    <option value="">V√§lj m√§rke</option>
                                    <option value="Honda">Honda</option>
                                    <option value="Yamaha">Yamaha</option>
                                    <option value="KTM">KTM</option>
                                    <option value="Kawasaki">Kawasaki</option>
                                    <option value="Suzuki">Suzuki</option>
                                    <option value="Husqvarna">Husqvarna</option>
                                    <option value="GasGas">GasGas</option>
                                    <option value="Beta">Beta</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Pris (kr)</label>
                                <input type="number" name="price" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required min="0" step="1000">
                            </div>
                            <div class="flex items-end">
                                <button type="submit" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded transition-colors">
                                    L√§gg till
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Riders Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="bg-gray-800 border-b border-cyan-400">
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">Nummer</th>
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">Namn</th>
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">Coast</th>
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">M√§rke</th>
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">Pris (kr)</th>
                                    <th class="px-4 py-3 text-center text-cyan-400 font-semibold">√Ötg√§rder</th>
                                </tr>
                            </thead>
                            <tbody id="riders-250">
                                {% for rider in riders_250_east %}
                                <tr class="rider-item border-b border-gray-700 hover:bg-gray-800">
                                    <td class="rider-number px-4 py-3 text-white">{{ rider.rider_number }}</td>
                                    <td class="rider-name px-4 py-3 text-white">{{ rider.name }}</td>
                                    <td class="px-4 py-3">
                                        <span class="px-2 py-1 rounded text-xs font-semibold bg-green-600 text-white">East</span>
                                    </td>
                                    <td class="rider-bike px-4 py-3 text-white">{{ rider.bike_brand }}</td>
                                    <td class="rider-price px-4 py-3 text-white">{{ "{:,.0f}".format(rider.price) }}</td>
                                    <td class="px-4 py-3 text-center">
                                        <button onclick="editRider({{ rider.id }}, '{{ rider.name }}', {{ rider.rider_number }}, '{{ rider.bike_brand }}', '250cc', 'east', {{ rider.price }})" 
                                                class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs mr-2">
                                            Redigera
                                        </button>
                                        <button onclick="deleteRider({{ rider.id }}, '{{ rider.name }}')" 
                                                class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs">
                                            Ta bort
                                        </button>
                                    </td>
                                </tr>
                                {% endfor %}
                                {% for rider in riders_250_west %}
                                <tr class="rider-item border-b border-gray-700 hover:bg-gray-800">
                                    <td class="rider-number px-4 py-3 text-white">{{ rider.rider_number }}</td>
                                    <td class="rider-name px-4 py-3 text-white">{{ rider.name }}</td>
                                    <td class="px-4 py-3">
                                        <span class="px-2 py-1 rounded text-xs font-semibold bg-orange-600 text-white">West</span>
                                    </td>
                                    <td class="rider-bike px-4 py-3 text-white">{{ rider.bike_brand }}</td>
                                    <td class="rider-price px-4 py-3 text-white">{{ "{:,.0f}".format(rider.price) }}</td>
                                    <td class="px-4 py-3 text-center">
                                        <button onclick="editRider({{ rider.id }}, '{{ rider.name }}', {{ rider.rider_number }}, '{{ rider.bike_brand }}', '250cc', 'west', {{ rider.price }})" 
                                                class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs mr-2">
                                            Redigera
                                        </button>
                                        <button onclick="deleteRider({{ rider.id }}, '{{ rider.name }}')" 
                                                class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs">
                                            Ta bort
                                        </button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 450cc Tab -->
        <div id="450" class="tab-content">
            <div class="bg-gradient-to-r from-gray-900 to-black rounded-lg shadow-2xl border-2 border-cyan-400 overflow-hidden" style="box-shadow: 0 0 20px rgba(34, 211, 238, 0.3);">
                <div class="bg-gradient-to-r from-cyan-500 to-blue-500 px-4 py-3" style="box-shadow: 0 0 15px rgba(34, 211, 238, 0.5);">
                    <h2 class="text-xl font-bold text-center text-white" style="text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);">üèçÔ∏è 450cc Riders</h2>
                </div>
                <div class="p-4 bg-gray-900">
                    <!-- Add New Rider Form -->
                    <div class="mb-6 p-4 bg-gray-800 rounded border border-cyan-400" style="box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);">
                        <h3 class="text-lg font-semibold text-cyan-400 mb-4">‚ûï L√§gg till ny f√∂rare</h3>
                        <form id="add-rider-form-450" class="grid grid-cols-1 md:grid-cols-5 gap-4">
                            <input type="hidden" name="class_name" value="450cc">
                            <input type="hidden" name="coast_250" value="">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Nummer</label>
                                <input type="number" name="rider_number" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Namn</label>
                                <input type="text" name="name" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">M√§rke</label>
                                <select name="bike_brand" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                                    <option value="">V√§lj m√§rke</option>
                                    <option value="Honda">Honda</option>
                                    <option value="Yamaha">Yamaha</option>
                                    <option value="KTM">KTM</option>
                                    <option value="Kawasaki">Kawasaki</option>
                                    <option value="Suzuki">Suzuki</option>
                                    <option value="Husqvarna">Husqvarna</option>
                                    <option value="GasGas">GasGas</option>
                                    <option value="Beta">Beta</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Pris (kr)</label>
                                <input type="number" name="price" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required min="0" step="1000">
                            </div>
                            <div class="flex items-end">
                                <button type="submit" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded transition-colors">
                                    L√§gg till
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Riders Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="bg-gray-800 border-b border-cyan-400">
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">Nummer</th>
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">Namn</th>
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">M√§rke</th>
                                    <th class="px-4 py-3 text-left text-cyan-400 font-semibold">Pris (kr)</th>
                                    <th class="px-4 py-3 text-center text-cyan-400 font-semibold">√Ötg√§rder</th>
                                </tr>
                            </thead>
                            <tbody id="riders-450">
                                {% for rider in riders_450 %}
                                <tr class="rider-item border-b border-gray-700 hover:bg-gray-800">
                                    <td class="rider-number px-4 py-3 text-white">{{ rider.rider_number }}</td>
                                    <td class="rider-name px-4 py-3 text-white">{{ rider.name }}</td>
                                    <td class="rider-bike px-4 py-3 text-white">{{ rider.bike_brand }}</td>
                                    <td class="rider-price px-4 py-3 text-white">{{ "{:,.0f}".format(rider.price) }}</td>
                                    <td class="px-4 py-3 text-center">
                                        <button onclick="editRider({{ rider.id }}, '{{ rider.name }}', {{ rider.rider_number }}, '{{ rider.bike_brand }}', '450cc', '', {{ rider.price }})" 
                                                class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs mr-2">
                                            Redigera
                                        </button>
                                        <button onclick="deleteRider({{ rider.id }}, '{{ rider.name }}')" 
                                                class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs">
                                            Ta bort
                                        </button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-gray-900 rounded-lg border-2 border-cyan-400 p-6 w-full max-w-md max-h-[85vh] overflow-y-auto" style="box-shadow: 0 0 20px rgba(34, 211, 238, 0.3);">
                <h3 class="text-lg font-semibold text-cyan-400 mb-4">Redigera f√∂rare</h3>
                <form id="edit-rider-form">
                    <input type="hidden" id="edit-rider-id">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Nummer</label>
                            <input type="number" id="edit-rider-number" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Smeknamn</label>
                                <input type="text" id="edit-rider-nickname" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">F√∂dd (YYYY-MM-DD)</label>
                                <input type="text" id="edit-rider-birthdate" placeholder="1992-03-25" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Hometown</label>
                                <input type="text" id="edit-rider-hometown" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Boende</label>
                                <input type="text" id="edit-rider-residence" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">L√§ngd (cm)</label>
                                <input type="number" id="edit-rider-height" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Vikt (kg)</label>
                                <input type="number" id="edit-rider-weight" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Team</label>
                                <input type="text" id="edit-rider-team" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Manufacturer</label>
                                <input type="text" id="edit-rider-manufacturer" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Team Manager</label>
                                <input type="text" id="edit-rider-teammanager" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Mechanic</label>
                                <input type="text" id="edit-rider-mechanic" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Turned Pro (√•r)</label>
                                <input type="number" id="edit-rider-turnedpro" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Bild URL</label>
                                <input type="text" id="edit-rider-imageurl" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Instagram (@namn)</label>
                                <input type="text" id="edit-rider-instagram" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Twitter (@namn)</label>
                                <input type="text" id="edit-rider-twitter" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Facebook (@namn)</label>
                                <input type="text" id="edit-rider-facebook" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Webb</label>
                                <input type="text" id="edit-rider-website" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Biografi</label>
                            <textarea id="edit-rider-bio" rows="4" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Meriter</label>
                            <textarea id="edit-rider-achievements" rows="4" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Namn</label>
                            <input type="text" id="edit-rider-name" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                        </div>
                        <div id="edit-coast-section" style="display: none;">
                            <label class="block text-sm font-medium text-gray-300 mb-1">Coast</label>
                            <select id="edit-rider-coast" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white">
                                <option value="">V√§lj coast</option>
                                <option value="east">East</option>
                                <option value="west">West</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">M√§rke</label>
                            <select id="edit-rider-brand" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required>
                                <option value="">V√§lj m√§rke</option>
                                <option value="Honda">Honda</option>
                                <option value="Yamaha">Yamaha</option>
                                <option value="KTM">KTM</option>
                                <option value="Kawasaki">Kawasaki</option>
                                <option value="Suzuki">Suzuki</option>
                                <option value="Husqvarna">Husqvarna</option>
                                <option value="GasGas">GasGas</option>
                                <option value="Beta">Beta</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Pris (kr)</label>
                            <input type="number" id="edit-rider-price" class="w-full px-3 py-2 bg-gray-700 border border-cyan-400 rounded text-white" required min="0" step="1000">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button type="button" onclick="closeEditModal()" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors">
                            Avbryt
                        </button>
                        <button type="submit" class="px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors">
                            Spara
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Search functionality
        function searchRiders() {
            const searchTerm = document.getElementById('riderSearch').value.toLowerCase().trim();
            const resultsDiv = document.getElementById('searchResults');
            const resultsList = document.getElementById('searchResultsList');
            
            if (!searchTerm) {
                resultsDiv.classList.add('hidden');
                return;
            }
            
            // Get all riders from both tabs
            const allRiders = [];
            document.querySelectorAll('.rider-item').forEach(item => {
                const name = item.querySelector('.rider-name')?.textContent?.toLowerCase() || '';
                const number = item.querySelector('.rider-number')?.textContent?.toLowerCase() || '';
                const team = item.querySelector('.rider-team')?.textContent?.toLowerCase() || '';
                const bike = item.querySelector('.rider-bike')?.textContent?.toLowerCase() || '';
                const price = item.querySelector('.rider-price')?.textContent?.toLowerCase() || '';
                
                if (name.includes(searchTerm) || number.includes(searchTerm) || team.includes(searchTerm) || bike.includes(searchTerm) || price.includes(searchTerm)) {
                    allRiders.push({
                        element: item,
                        name: item.querySelector('.rider-name')?.textContent || '',
                        number: item.querySelector('.rider-number')?.textContent || '',
                        team: item.querySelector('.rider-team')?.textContent || '',
                        bike: item.querySelector('.rider-bike')?.textContent || '',
                        price: item.querySelector('.rider-price')?.textContent || ''
                    });
                }
            });
            
            if (allRiders.length === 0) {
                resultsList.innerHTML = '<p class="text-gray-500 dark:text-gray-400">Inga f√∂rare hittades</p>';
            } else {
                resultsList.innerHTML = allRiders.map(rider => `
                    <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg border border-gray-200 dark:border-gray-600">
                        <div class="flex items-center justify-between">
                            <div>
                                <span class="font-semibold text-gray-800 dark:text-white">${rider.name}</span>
                                <span class="text-gray-600 dark:text-gray-400 ml-2">#${rider.number}</span>
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">
                                ${rider.team} ‚Ä¢ ${rider.bike} ‚Ä¢ ${rider.price} kr
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            resultsDiv.classList.remove('hidden');
        }
        
        function clearSearch() {
            document.getElementById('riderSearch').value = '';
            document.getElementById('searchResults').classList.add('hidden');
        }
        
        // Allow search on Enter key
        document.getElementById('riderSearch').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchRiders();
            }
        });

        // Tab functionality
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.dataset.tab;
                
                // Remove active class from all buttons and content
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked button and corresponding content
                button.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Add rider forms
        document.querySelectorAll('[id^="add-rider-form-"]').forEach(form => {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData(form);
                const data = Object.fromEntries(formData);
                
                try {
                    const response = await fetch('/api/riders', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    if (response.ok) {
                        location.reload();
                    } else {
                        alert('Fel vid till√§gg av f√∂rare');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Fel vid till√§gg av f√∂rare');
                }
            });
        });

        // Edit rider
        function editRider(id, name, number, brand, className, coast, price) {
            document.getElementById('edit-rider-id').value = id;
            document.getElementById('edit-rider-name').value = name;
            document.getElementById('edit-rider-number').value = number;
            document.getElementById('edit-rider-brand').value = brand;
            document.getElementById('edit-rider-price').value = price;
            
            // Show/hide coast section based on class
            const coastSection = document.getElementById('edit-coast-section');
            if (className === '250cc') {
                coastSection.style.display = 'block';
                document.getElementById('edit-rider-coast').value = coast;
            } else {
                coastSection.style.display = 'none';
            }
            
            document.getElementById('edit-modal').classList.remove('hidden');
        }

        // Close edit modal
        function closeEditModal() {
            document.getElementById('edit-modal').classList.add('hidden');
        }

        // Edit rider form
        document.getElementById('edit-rider-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const id = document.getElementById('edit-rider-id').value;
            const data = {
                name: document.getElementById('edit-rider-name').value,
                rider_number: parseInt(document.getElementById('edit-rider-number').value),
                bike_brand: document.getElementById('edit-rider-brand').value,
                price: parseInt(document.getElementById('edit-rider-price').value),
                nickname: document.getElementById('edit-rider-nickname').value,
                birthdate: document.getElementById('edit-rider-birthdate').value,
                hometown: document.getElementById('edit-rider-hometown').value,
                residence: document.getElementById('edit-rider-residence').value,
                height_cm: document.getElementById('edit-rider-height').value,
                weight_kg: document.getElementById('edit-rider-weight').value,
                team: document.getElementById('edit-rider-team').value,
                manufacturer: document.getElementById('edit-rider-manufacturer').value,
                team_manager: document.getElementById('edit-rider-teammanager').value,
                mechanic: document.getElementById('edit-rider-mechanic').value,
                turned_pro: document.getElementById('edit-rider-turnedpro').value,
                image_url: document.getElementById('edit-rider-imageurl').value,
                instagram: document.getElementById('edit-rider-instagram').value,
                twitter: document.getElementById('edit-rider-twitter').value,
                facebook: document.getElementById('edit-rider-facebook').value,
                website: document.getElementById('edit-rider-website').value,
                bio: document.getElementById('edit-rider-bio').value,
                achievements: document.getElementById('edit-rider-achievements').value
            };
            
            // Add coast if it's a 250cc rider
            const coastSection = document.getElementById('edit-coast-section');
            if (coastSection.style.display !== 'none') {
                data.coast_250 = document.getElementById('edit-rider-coast').value;
            }
            
            try {
                const response = await fetch(`/api/riders/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    location.reload();
                } else {
                    alert('Fel vid uppdatering av f√∂rare');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Fel vid uppdatering av f√∂rare');
            }
        });

        // Delete rider
        function deleteRider(id, name) {
            if (confirm(`√Ñr du s√§ker p√• att du vill ta bort ${name}?`)) {
                fetch(`/api/riders/${id}`, {
                    method: 'DELETE'
                })
                .then(response => {
                    if (response.ok) {
                        location.reload();
                    } else {
                        alert('Fel vid borttagning av f√∂rare');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Fel vid borttagning av f√∂rare');
                });
            }
        }
    </script>
</body>
</html>
